<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Products</title>
</head>

<body th:replace="layout :: layout ('Products', ~{::section})">
    <section>
        <div class="page-intro">
            <h2>Product Studio</h2>
            <p>Curate and manage every listing with live inventory data.</p>
        </div>
        <div class="two-col">
            <div class="card">
                <h3>Add Listing</h3>
                <form th:action="@{/products/add}" method="post">
                    <div>
                        <label>Seller</label>
                        <select name="sellerId" required>
                            <option value="">Pick seller</option>
                            <option th:each="user : ${users}" th:value="${user.id}" th:text="${user.name}"></option>
                        </select>
                    </div>
                    <div>
                        <label>Title</label>
                        <input name="title" required>
                    </div>
                    <div>
                        <label>Description</label>
                        <textarea name="description" required></textarea>
                    </div>
                    <div>
                        <label>Price</label>
                        <input type="number" step="0.01" min="0" name="price" required>
                    </div>
                    <div>
                        <label>Stock</label>
                        <input type="number" min="0" name="stock" required>
                    </div>
                    <div>
                        <label>Category</label>
                        <input name="category" required>
                    </div>
                    <button type="submit">Create Listing</button>
                </form>
            </div>
            <div class="card">
                <h3>Search Listings</h3>
                <form method="get" th:action="@{/products}">
                    <div>
                        <label>Keyword</label>
                        <input name="search" th:value="${search}">
                    </div>
                    <button type="submit">Search</button>
                </form>
            </div>
        </div>
        <div class="table-shell" style="margin-top: 2rem;">
            <table>
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Seller</th>
                        <th>Category</th>
                        <th>Stock</th>
                        <th>Rating</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="product : ${products}">
                        <td th:text="${product.title}">Title</td>
                        <td th:text="${product.sellerId}">Seller</td>
                        <td th:text="${product.category}">Cat</td>
                        <td th:text="${product.stock}">0</td>
                        <td th:text="${#numbers.formatDecimal(productRatings[product.id], 1, 1)}">0</td>
                        <td>
                            <a class="ghost-btn" th:href="@{'/products/' + ${product.id}}">Details</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
</body>

</html>